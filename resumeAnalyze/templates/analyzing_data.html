<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Analyzing Resume - Please Wait</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .loading-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 60px 40px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            text-align: center;
            max-width: 500px;
            width: 90%;
            border: 1px solid rgba(255, 255, 255, 0.2);
            animation: fadeIn 0.8s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .loading-icon {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 30px;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            animation: pulse 2s infinite;
        }

        .loading-icon i {
            color: white;
            font-size: 2.5em;
            animation: spin 2s linear infinite;
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }

        .loading-title {
            font-size: 2.2em;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 15px;
        }

        .loading-subtitle {
            color: #718096;
            font-size: 1.1em;
            margin-bottom: 40px;
            line-height: 1.5;
        }

        .progress-container {
            margin-bottom: 30px;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e2e8f0;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 10px;
            transition: width 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.4),
                transparent
            );
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% {
                transform: translateX(-100%);
            }
            100% {
                transform: translateX(100%);
            }
        }

        .percentage {
            font-size: 3em;
            font-weight: 800;
            color: #2d3748;
            margin: 20px 0;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .status-text {
            font-size: 1.1em;
            color: #4a5568;
            font-weight: 500;
            margin-bottom: 30px;
            min-height: 1.5em;
        }

        .loading-steps {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding: 20px 0;
            border-top: 1px solid #e2e8f0;
        }

        .step {
            flex: 1;
            text-align: center;
            opacity: 0.4;
            transition: all 0.3s ease;
        }

        .step.active {
            opacity: 1;
            color: #667eea;
        }

        .step i {
            display: block;
            font-size: 1.5em;
            margin-bottom: 8px;
        }

        .step span {
            font-size: 0.85em;
            font-weight: 500;
        }

        .dots {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }

        .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #cbd5e0;
            margin: 0 4px;
            animation: bounce 1.4s infinite ease-in-out both;
        }

        .dot:nth-child(1) { animation-delay: -0.32s; }
        .dot:nth-child(2) { animation-delay: -0.16s; }
        .dot:nth-child(3) { animation-delay: 0s; }

        @keyframes bounce {
            0%, 80%, 100% {
                transform: scale(0);
                opacity: 0.5;
            } 40% {
                transform: scale(1);
                opacity: 1;
                background: #667eea;
            }
        }

        @media (max-width: 600px) {
            .loading-container {
                padding: 40px 30px;
                margin: 20px;
            }
            
            .loading-title {
                font-size: 1.8em;
            }
            
            .percentage {
                font-size: 2.5em;
            }

            .loading-steps {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="loading-container">
        <div class="loading-icon">
            <i class="fas fa-cog"></i>
        </div>
        
        <h2 class="loading-title">Analyzing Your Resume</h2>
        <p class="loading-subtitle">Our AI is carefully reviewing your resume and providing detailed insights</p>
        
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>
        
        <div class="percentage" id="percentage">0%</div>
        <div class="status-text" id="statusText">Initializing analysis...</div>
        
        <div class="loading-steps">
            <div class="step active" id="step1">
                <i class="fas fa-upload"></i>
                <span>Processing</span>
            </div>
            <div class="step" id="step2">
                <i class="fas fa-search"></i>
                <span>Analyzing</span>
            </div>
            <div class="step" id="step3">
                <i class="fas fa-chart-line"></i>
                <span>Generating</span>
            </div>
            <div class="step" id="step4">
                <i class="fas fa-check"></i>
                <span>Complete</span>
            </div>
        </div>
        
        <div class="dots">
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
        </div>
    </div>

    <script>
        let percentage = 0;
        const progressFill = document.getElementById('progressFill');
        const percentageElement = document.getElementById('percentage');
        const statusText = document.getElementById('statusText');
        
        // Status messages for different progress ranges
        const statusMessages = [
            "Initializing analysis...",
            "Reading resume content...",
            "Extracting key information...",
            "Analyzing skills and experience...",
            "Checking formatting and structure...",
            "Evaluating content quality...",
            "Comparing with industry standards...",
            "Generating recommendations...",
            "Calculating match score...",
            "Finalizing analysis results...",
            "Analysis complete!"
        ];

        // Step activation points
        const stepPoints = [25, 50, 75, 100];
        
        function updateProgress() {
            // Increment percentage with random speed for realistic feel
            const increment = Math.random() * 3 + 1; // Random between 1-4
            percentage = Math.min(percentage + increment, 100);
            
            // Update progress bar and percentage display
            progressFill.style.width = percentage + '%';
            percentageElement.textContent = Math.floor(percentage) + '%';
            
            // Update status message based on progress
            const messageIndex = Math.floor((percentage / 100) * (statusMessages.length - 1));
            statusText.textContent = statusMessages[messageIndex];
            
            // Activate steps based on progress
            stepPoints.forEach((point, index) => {
                const step = document.getElementById(`step${index + 1}`);
                if (percentage >= point) {
                    step.classList.add('active');
                }
            });
            
            // When complete, redirect or show completion
            if (percentage >= 100) {
                setTimeout(() => {
                    // Option 1: Redirect to results page
                    window.location.href = '{% url "analyzer" resume_id %}';
                                       
                    // Option 2: Or show completion message
                    // statusText.textContent = "Redirecting to results...";
                    // setTimeout(() => {
                    //     window.location.href = '/results/';
                    // }, 1500);
                }, 1000);
            } else {
                // Continue updating progress
                setTimeout(updateProgress, Math.random() * 200 + 100); // Random delay between 100-300ms
            }
        }
        
        // Start the progress animation after page loads
        setTimeout(() => {
            updateProgress();
        }, 500);
        
        // Add some dynamic icon changes
        const icons = ['fa-cog', 'fa-sync-alt', 'fa-brain', 'fa-chart-bar'];
        let iconIndex = 0;
        
        setInterval(() => {
            const iconElement = document.querySelector('.loading-icon i');
            iconElement.className = `fas ${icons[iconIndex]}`;
            iconIndex = (iconIndex + 1) % icons.length;
        }, 2000);
    </script>
</body>
</html>
